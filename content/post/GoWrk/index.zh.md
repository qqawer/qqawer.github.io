---
title: "Go-Wrk 核心参数详解"
description: "一篇搞懂 Go-Wrk 的核心参数：-n, -t, -c, -d"
date: 2026-01-31
slug: "go-wrk-parameters"
image: "helena-hertz-wWZzXlDpMog-unsplash.jpg"
categories:
    - Documentation
tags:
    - Go-Wrk
    - Go
toc: true
---

在进行 HTTP 压测时，精准控制压测的**力度**和**时长**是获取有效数据的关键。`go-wrk` 的设计非常简洁，你只需要掌握以下 **4 个核心参数**，就能覆盖 99% 的压测场景。

## 🚀 核心参数速查表

| 参数 | 全称 | 核心作用 | 推荐值 |
|:---:|:---|:---|:---|
| **`-c`** | Connections | **并发连接数** (类似于虚拟用户数) | `50` - `100` |
| **`-t`** | Threads | **压测线程数** (利用多核 CPU 发力) | 等于 CPU 核心数 (如 `8`) |
| **`-n`** | Number | **总请求次数** (压测的总量) | `10000`+ |
| **`-d`** | Duration | **压测时长** (限制压测时间) | `30s` - `60s` |

---

## 🎯 深度解析

### 1. ⚡️ 并发控制：`-c` 与 `-t`

这两个参数决定了你能给服务器多大的压力。

#### `-c` (Connections)
> **也就是“有多少人同时在访问”。**

这是控制**并发量**最直接的参数。它控制 `go-wrk` 还会维持多少个 TCP 连接与服务器通信。
*   **设置太小**：压力不够，服务器觉得“毫无波澜”。
*   **设置太大**：容易耗尽客户端端口，或者导致上下文切换过高，测试结果反而不准。
*   **✅ 建议**：从 `50` 开始尝试，逐渐增加至 `100` 或 `200`。

#### `-t` (Threads)
> **也就是“有多少条流水线在工作”。**

因为 `go-wrk` 是基于 Go 语言实现的，这个参数控制它开启多少个 goroutine (协程) 调度器来处理请求。
*   **重要**：如果不设置，默认是 1，这会成为**压测工具自身的瓶颈**（你的电脑 CPU 没跑满，压测也就上不去）。
*   **✅ 建议**：设置为你机器的 **CPU 核心数** (例如 8 核就设 8)，让压测工具火力全开。

---

### 2. ⏱ 停止条件：`-n` 与 `-d`

这两个参数决定了压测什么时候结束。**只要满足其中任意一个条件，压测就会立即停止。**

#### `-n` (Number of Requests)
> **“我们要跑多少个订单？”**

指定压测的总请求数量。
*   用于精确控制测试样本量。比如你想看“处理 100 万个请求需要多久”，就用这个。
*   **✅ 场景**：基准测试，对比不同版本的性能差异。

#### `-d` (Duration)
> **“我们要跑多久？”**

指定压测持续的时间（支持 `s` 秒, `m` 分, `h` 时）。
*   **✅ 场景**：稳定性测试。比如“让系统在高负载下跑 10 分钟”，看会不会内存泄漏或崩溃。

> ⚠️ **注意**：
> 如果你同时设置了 `-n 1000000` 和 `-d 30s`，**哪个先达到就按哪个停**。
> *   如果 30 秒到了但只跑了 50 万次 -> **停**。
> *   如果 10 秒就跑完了 100 万次 -> **停**。

---

## 💡 最佳实践命令

结合你的压测场景，这是一个**既能充分施压，又不会把自己机器跑挂**的黄金组合：

```bash
# 8线程 | 50并发 | 总量100万请求 | 最长跑60秒
go-wrk -t 8 -c 50 -n 1000000 -d 60s http://127.0.0.1:8080/api/v1/posts
```

**参数解读：**
1.  **`-t 8`**：火力全开，利用 8 核 CPU。
2.  **`-c 50`**：模拟 50 个用户同时操作，压力适中。
3.  **`-n 1000000`**：测试样本足够大，结果更可信。
4.  **`-d 60s`**：防止意外情况跑太久，最多 1 分钟收工。